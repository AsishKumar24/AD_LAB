-- Create Database
CREATE DATABASE EMPLOYEE_NEW;
USE EMPLOYEE_NEW;

-- Create POSITION Table
CREATE TABLE POSITION (
    POSITIONID INT PRIMARY KEY,
    POSDESC VARCHAR(50) NOT NULL
);

-- Create EMPLOYEE Table
CREATE TABLE EMPLOYEE (
    EMPLOYEE_ID INT PRIMARY KEY,
    LNAME VARCHAR(20) NOT NULL,
    FNAME VARCHAR(20) NOT NULL,
    POSITIONID INT NOT NULL,
    SUPERVISOR_ID INT,  
    HIRE_DATE DATE NOT NULL,
    SALARY INT NOT NULL,
    COMISSION INT DEFAULT 0,
    FOREIGN KEY (POSITIONID) REFERENCES POSITION (POSITIONID) ON DELETE CASCADE,
    FOREIGN KEY (SUPERVISOR_ID) REFERENCES EMPLOYEE(EMPLOYEE_ID) ON DELETE SET NULL
);
-- Create DEPENDENT Table with DEPENDENT_NAME
CREATE TABLE DEPENDENT (
    DEPENDENTID INT PRIMARY KEY,
    EMPLOYEEID INT NOT NULL,
    DEPENDENT_NAME VARCHAR(50) NOT NULL,
    DEPDOB DATE NOT NULL,
    RELATION VARCHAR(20) NOT NULL,
    FOREIGN KEY (EMPLOYEEID) REFERENCES EMPLOYEE(EMPLOYEE_ID) ON DELETE CASCADE
);

-- Insert Data into POSITION Table
INSERT INTO POSITION (POSITIONID, POSDESC) 
VALUES (601, "CTO"), (602, "HR"), (603, "TECH LEAD"), (604, "CFO"), (605, "FINANCE EXECUTIVE");

-- Insert Data into EMPLOYEE Table
INSERT INTO EMPLOYEE (EMPLOYEE_ID, LNAME, FNAME, POSITIONID, SUPERVISOR_ID, HIRE_DATE, SALARY, COMISSION) 
VALUES (101, "GUPTA", "AMAN", 601, NULL, "2016-03-26", 120000, 1200),
       (102, "SINGH", "ROCKET", 602, NULL, "2020-03-22", 1300000, 5000),
       (103, "MIRZA", "SABRIN", 603, 101, "2023-11-27", 20000000, 0),
       (104, "PATHAK", "TANIYA", 604, 102, "2015-09-23", 23000, 1500),
       (105, "SINGH", "JAY", 605, 103, "2019-02-20", 180000, 0),
       (111, "MUNI", "JIGNA", 605, 104, "2022-09-16", 750000, 6000);

-- Insert Data into DEPENDENT Table (Including Additional Entry for EMPLOYEE_ID = 111)
INSERT INTO DEPENDENT (DEPENDENTID, EMPLOYEEID, DEPENDENT_NAME, DEPDOB, RELATION) 
VALUES (201, 101, "Aarav Gupta", "2005-01-27", "Daughter"),
       (202, 102, "Neha Singh", "1992-03-20", "Spouse"),
       (203, 103, "Farida Mirza", "1970-05-10", "Mother"),
       (204, 104, "Tanisha Padhi", "2014-09-17", "Sister"),
       (205, 105, "Rajendra Singh", "1968-10-23", "Father"),
       (206, 111, "Aditya Muni", "2016-06-12", "Father"),  -- New entry for EMP_ID 111
       (207, 111, "Geeta Muni", "1995-08-19", "Mother"); -- Another dependent for EMP_ID 111

-- Select Queries for Testing
SELECT * FROM EMPLOYEE;
SELECT CONCAT(FNAME, " ", LNAME) AS EMPLOYEE_NAME, SALARY AS INCOME FROM EMPLOYEE;
SELECT * FROM DEPENDENT;
SELECT * FROM POSITION;
